'use strict';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key]}}}return target};var _require=require('path'),resolve=_require.resolve;var _require2=require('chalk'),blue=_require2.blue,green=_require2.green;var webpack=require('webpack');var HTMLWebpackPlugin=require('html-webpack-plugin');var StringReplacePlugin=require('string-replace-webpack-plugin');var ProgressBarWebpackPlugin=require('progress-bar-webpack-plugin');var AppSettings=require('../../../AppSettings');var themes=require('../../Themes');var convertLanguageToISO=require('../helpers/convertLanguageToISO');var _require3=require('../../environment'),ENV=_require3.ENV,isDev=_require3.isDev,isProd=_require3.isProd;var appSettings=AppSettings.getInstance();var appConfig=appSettings.getAppSettings();var frontendSettings=appSettings.getFrontendSettings();var componentsConfig=appSettings.getComponentsSettings();var THEME_PATH=themes.getPath();var THEME_NAME=themes.getName();var PUBLIC_FOLDER='public';var LANG=convertLanguageToISO(appConfig.language);var plugins=[new StringReplacePlugin,new HTMLWebpackPlugin({title:appConfig.shopName||THEME_NAME,filename:resolve(THEME_PATH,PUBLIC_FOLDER,'index.html'),template:resolve(__dirname,'../templates/index.ejs'),inject:false,cache:false,minify:false}),new webpack.DefinePlugin({'process.env':{NODE_ENV:JSON.stringify(ENV),APP_CONFIG:JSON.stringify(_extends({},appConfig,{appId:appConfig.id})),COMPONENTS_CONFIG:JSON.stringify(componentsConfig),LANG:JSON.stringify(LANG),IP:JSON.stringify(frontendSettings.getIpAddress()),PORT:JSON.stringify(frontendSettings.getApiPort())}}),new webpack.LoaderOptionsPlugin({debug:isDev,options:{context:THEME_PATH,output:{path:resolve(THEME_PATH,PUBLIC_FOLDER)}}}),new webpack.IgnorePlugin,new webpack.optimize.ModuleConcatenationPlugin,new webpack.optimize.CommonsChunkPlugin({minChunks:2,name:'common',filename:isProd?'[name].[chunkhash].js':'[name].js'}),new webpack.HashedModuleIdsPlugin,new ProgressBarWebpackPlugin({format:'  building ['+blue(':bar')+'] [:msg] '+green(':percent')+' (:elapsed seconds)',clear:false})];module.exports=plugins;